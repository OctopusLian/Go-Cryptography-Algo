# 对称加密算法  

对称加密（也叫私钥加密算法）指加密和解密使用相同密钥的加密算法。它要求发送方和接收方在安全通信之前，商定一个密钥。对称算法的安全性依赖于密钥，泄露密钥就意味着任何人都可以对他们发送或接收的消息解密，所以密钥的保密性对通信的安全性至关重要。对称加密算法的优点是计算量小，加密速度快，加密效率高。不足之处是，参与方需要提前持有密钥，一旦有人泄露则系统安全性被破坏；另外，如何在不安全通道中提前分发密钥也是个问题，密钥管理非常困难。  

基于“对称密钥”的加密算法主要有DES、3DES（TripleDES）、AES、RC2、RC4、RC5和Blowfish等。  

## DES和3DES算法  

数据加密标准算法（Data Encryption Standard，DES）是加密和解密使用相同密钥的加密算法，也叫作单密钥算法或私钥加密算法，是传统的密钥算法。它是IBM公司于1975年研究成功并公开发表的。  

DES算法的入口参数有3个：Key、Data、Mode。  

• Key是DES算法的工作密钥，8个字节共64位。  
• Data是要被加密或被解密的数据。  
• Mode为DES的工作方式，有两种：加密或解密。  

## AES算法  

高级加密标准算法（Advanced Encryption Standard，AES）由美国国家标准与技术研究院（NIST）于2001年11月26日发布，并在2002年5月26日成为有效的标准。2006年，AES算法已然成为对称密钥加密中最流行的算法之一。该算法与其他对称加密算法相比更安全，效率更高。  

AES算法使用128位、192位或者256位的密钥长度（密钥分别是16字节、24字节、32字节），使得它比密钥长度为56位的DES算法更健壮可靠。  

2^64这个数大于全球小麦1000年的产量。如果1微秒验证1个密码（1秒验证100万个），穷举需要58万年。  

10^80是当前人类可见宇宙中所有物质原子数目的总和。  

### AES的加密模式  

- ECB：最基本的加密模式，也就是通常理解的加密。相同的明文将永远加密成相同的密文，无初始向量，容易受到密码本重放攻击，一般情况下很少用。  
- CBC：明文被加密前要与前面的密文进行异或运算，因此只要选择不同的初始向量，相同的明文加密后会形成不同的密文。这是目前应用最广泛的模式。CBC加密后的密文是上下文相关的，但明文的错误不会传递到后续分组；但如果一个分组丢失，后面的分组将全部作废（同步错误）。  
- CFB：类似于自同步序列密码，分组加密后，按8位分组将密文和明文进行移位异或后得到输出，同时反馈回移位寄存器。优点是最小可以按字节进行加解密，也可以是n位的。CFB也是上下文相关的，CFB模式下，明文的一个错误会影响后面的密文（错误扩散）。  
- OFB：将分组密码作为同步序列密码运行，和CFB相似。不过OFB用前一个n位密文输出分组反馈回移位寄存器，没有错误扩散问题  

### 填充方式  

PKCSS填充  

```
每个填充的字节都记录了填充的总字节数。
“a”填充后结果为：[97 7 7 7 7 7 7 7]。
“ab”填充后结果为：[97 98 6 6 6 6 6 6]。
“—a”填充后结果为：[228 184 128 97 4 4 4 4]。
```

Zeros填充  

```
全部填充为0的字节。
“a”填充后结果为：[97 0 0 0 0 0 0 0]。
“ab”填充后结果为：[97 98 0 0 0 0 0 0]。
“—a”填充后结果为：[228 184 128 97 0 0 0 0]。
```
